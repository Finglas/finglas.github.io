<!DOCTYPE html>
<html lang="english">
<head>
        <meta charset="utf-8" />
        <title>Shaun Finglas - Stop.Mocking.EVERYTHING</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <link href="/feeds/posts/default.xml" type="application/atom+xml" rel="alternate" title="Shaun Finglas Atom Feed" />

        <link rel="icon" type="image/png" sizes="32x32" href="/theme/images/favicons/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/theme/images/favicons/favicon-16x16.png">
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Shaun Finglas</a></h1>
 <h2>Agile software development &amp; programming - one lesson at a time.</h2>                <nav><ul>
                    <li><a href="/pages/about.html">About Me</a></li>
                    <li><a href="/pages/series.html">Series</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2014/08/stopmockingeverything.html" rel="bookmark"
           title="Permalink to Stop.Mocking.EVERYTHING">Stop.Mocking.EVERYTHING</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-08-01T00:00:00+02:00">
                Published: Fri 01 August 2014
        </abbr>

<p>tags: <a href="/tag/programming.html">programming</a> <a href="/tag/retro.html">retro</a> <a href="/tag/tdd.html">tdd</a> </p>
</footer><!-- /.post-info -->      <p>I've flip flopped on how to use mock objects since 2008. It's took me
nearly five years to finally claim to have a solid, practical answer on
what is in my opinion, their correct use.</p>
<h4>Mock Everything</h4>
<p>Some developers told me to mock everything. Every. Single. Collaborator.
I wasn't sure about this approach.</p>
<ul>
<li>My tests felt too brittle - tied to implementation details.</li>
<li>My tests felt like a duplication of my production code.</li>
<li>Your test count rises rapidly.</li>
<li>This style of testing will slow you down - more to
    write/execute/debug.</li>
</ul>
<h4>Mock Nothing</h4>
<p>Some developers told me to mock nothing. Sometimes I never used mocks. I
wasn't sure about this approach either.</p>
<ul>
<li>My tests felt too loose - it was easy to introduce bugs or defects.</li>
<li>My production code suffered as I introduced accessors only for
    testing.</li>
</ul>
<p>No wonder I was confused. Neither approach seemed to be comfortable with
me.</p>
<h4>Solution</h4>
<ul>
<li>Use mocks for commands</li>
<li>Use stubs for queries</li>
</ul>
<p>This halfway house is built around the idea of <a href="http://martinfowler.com/bliki/CommandQuerySeparation.html">command and query
separation</a>
as detailed by <a href="http://blog.ploeh.dk/2013/10/23/mocks-for-commands-stubs-for-queries/">Mark
Seeman</a>.
This simple principle makes a lot of sense, and finally helped me
realise how best to use stubs and mocks.</p>
<ul>
<li>Any commands (methods that have no return type) should have a mock
    object verifying their use if they are architecturally significant.</li>
<li>Any queries (methods that have return types) should have a stub
    object that is returned if their use is architecturally significant.</li>
</ul>
<p>If the collaborator is not significant, or in other words is simply an
implementation detail then no mock or stub is needed. That's right, just
new up (or instantiate) your dependency there and then. This allows you
to refactor the internals aggressively, without the fear of breaking or
rewriting tests.</p>
<p>This approach has served me well for a while now, and in fact can be
achieved even without the need to use a complicated mocking framework,
though that will be the subject of a future post.</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="social">
                        <ul>
                            <li><a href="/feeds/posts/default.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="https://twitter.com/ShaunFinglas">Twitter</a></li>
                            <li><a href="https://github.com/Finglas">Github</a></li>
                            <li><a href="https://www.linkedin.com/in/shaunfinglas/">LinkedIn</a></li>
                            <li><a href="https://stackoverflow.com/users/102482/finglas">StackOverflow</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <p>Proudly powered by <a href="http://getpelican.com/">Pelican</a>. Theme based on <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>.</p>
                <p id="disclaimer">Disclaimer: The posts on this site are my own and don't necessarily represent my employers positions, strategies, or opinions.</p>
                <p>Copyright &copy; Shaun Finglas 2017</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-68423049-2', 'auto');
    ga('send', 'pageview');
    </script>
</body>
</html>